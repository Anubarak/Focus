/*==============================================================================
 ___  _   _    _
/   || | | |  | |
\__  | | | |  | |  __
/    |/  |/_) |/  /  \_/\/
\___/|__/| \_/|__/\__/  /\_/
              |\
              |/
Focus v1.5
https://github.com/Elkfox/Focus
Copyright (c) 2018 Elkfox Co Pty Ltd
https://elkfox.com
Project lead: George Butter
MIT License
==============================================================================*/
var Focus=function(t,e){if(this.target=t,this.element=jQuery(t),this.config={visibleClass:"visible",bodyClass:"active-popup",targetClass:null,sticky:null,innerSelector:".popup-inner",popupContent:".popup-content",autoFocusSelector:"[data-auto-focus]",slide:null,visible:!1},e)for(var n in e)this.config[n]=e[n];this.visible=this.config.visible,this.width=jQuery(this.config.popupContent).outerWidth(),this.config.sticky||jQuery(document).ready(function(){jQuery(t).detach().appendTo("body")}),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.toggle=this.toggle.bind(this),Focus.elements[t]=this};Focus.elements={},Focus.getTarget=function(t,e){jQuery(t).is("a")&&e.preventDefault();const n=jQuery(t).data("target");return target=n?n:null,target},Focus.eventHandler=function(t,e){var n=Focus.elements[t];if(!n)var n=new Focus(t);"hide"===e?n.hide():n.toggle()},Focus.prototype.show=function(){var t=this;return this.visible&&this.element.hasClass(this.config.visibleClass)?jQuery(document).trigger("focus:error",{error:"Popup already open"}):(this.config.targetClass&&jQuery('[data-target="'+this.target+'"]').addClass(this.config.targetClass),this.config.slide&&this.element.slideDown(),this.element.addClass(this.config.visibleClass),jQuery("body").addClass(this.config.bodyClass),this.visible=!0,jQuery(this.target+" "+this.config.autoFocusSelector).length&&setTimeout(function(){jQuery(t.target+" "+t.config.autoFocusSelector).focus()},300),this.element.on("click","[data-close]",function(e){var n=Focus.getTarget(jQuery(this),event);n?Focus.eventHandler(n,"hide"):t.hide()}),this.element.on("click",this.config.innerSelector,function(e){(jQuery(e.target).is(t.config.innerSelector)||0===jQuery(e.target).parents(t.config.target).length)&&t.hide()}),jQuery(document).on("keyup",this.element,function(e){27===e.keyCode&&(jQuery(document).off("keyup",this.element),t.hide())}),jQuery(document).trigger("focus:open",[this.target]))},Focus.prototype.hide=function(){return this.visible||this.element.hasClass(this.config.visibleClass)?(this.element.removeClass(this.config.visibleClass),this.config.targetClass&&jQuery('[data-target="'+this.target+'"]').removeClass(this.config.targetClass),this.config.slide&&this.element.slideUp(),jQuery("body").removeClass(this.config.bodyClass),this.element.off("click",this.config.innerSelector),this.element.off("click","[data-close]"),this.visible=!1,jQuery(document).trigger("focus:close",[this.target])):jQuery(document).trigger("focus:error",{error:"Focus element is already closed"})},Focus.prototype.toggle=function(){return this.visible?this.hide():this.show()},jQuery(document).ready(function(){jQuery(document).on("click","[data-trigger]",function(t){var e=($(this).data("trigger"),Focus.getTarget(jQuery(this),t));Focus.eventHandler(e,"toggle")}),jQuery(document).on("click","[data-close]",function(t){var e=Focus.getTarget(jQuery(this),t);e&&Focus.eventHandler(e,"hide")})});
