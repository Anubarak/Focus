var Focus=function(a,b){if(this.target=a,this.element=jQuery(a),this.config={visibleClass:"visible",bodyClass:"active-popup",targetClass:null,sticky:null,innerSelector:".popup-inner",autoFocusSelector:"[data-auto-focus]",slide:null,slideDuration:"fast",visible:!1},b)for(var c in b)this.config[c]=b[c];this.visible=this.config.visible,this.config.sticky||jQuery(document).ready(function(){jQuery(a).detach().appendTo("body")}),this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.toggle=this.toggle.bind(this),Focus.elements[a]=this};Focus.elements={},Focus.getTarget=function(a,b){jQuery(a).is("a")&&b.preventDefault();const c=jQuery(a).data("target");return target=c?c:null,target},Focus.eventHandler=function(a,b){var c=Focus.elements[a];if(!c)var c=new Focus(a);"hide"===b?c.hide():c.toggle()},Focus.prototype.show=function(){var a=this;return this.visible&&this.element.hasClass(this.config.visibleClass)?jQuery(document).trigger("focus:error",{error:"Popup already open"}):(this.config.targetClass&&jQuery("[data-target=\""+this.target+"\"]").addClass(this.config.targetClass),this.config.slide&&this.element.slideDown(this.config.slideDuration),(this.element.addClass(this.config.visibleClass),jQuery("body").addClass(this.config.bodyClass),this.visible=!0,jQuery(this.target+" "+this.config.autoFocusSelector).length&&setTimeout(function(){jQuery(a.target+" "+a.config.autoFocusSelector).focus()},300),this.element.on("click","[data-close]",function(){var b=Focus.getTarget(jQuery(this),event);b?Focus.eventHandler(b,"hide"):a.hide()}),this.element.on("click",this.config.innerSelector,function(b){(jQuery(b.target).is(a.config.innerSelector)||0===jQuery(b.target).parents(a.config.target).length)&&a.hide()}),jQuery(document).on("keyup",this.element,function(b){27===b.keyCode&&(jQuery(document).off("keyup",this.element),a.hide())}),jQuery(document).trigger("focus:open",[this.target])))},Focus.prototype.hide=function(){return this.visible||this.element.hasClass(this.config.visibleClass)?(this.element.removeClass(this.config.visibleClass),this.config.targetClass&&jQuery("[data-target=\""+this.target+"\"]").removeClass(this.config.targetClass),this.config.slide&&this.element.slideUp(this.config.slideDuration),(jQuery("body").removeClass(this.config.bodyClass),this.element.off("click",this.config.innerSelector),this.element.off("click","[data-close]"),this.visible=!1,jQuery(document).trigger("focus:close",[this.target]))):jQuery(document).trigger("focus:error",{error:"Focus element is already closed"})},Focus.prototype.toggle=function(){return this.visible?this.hide():this.show()},jQuery(document).ready(function(){jQuery(document).on("click","[data-trigger]",function(a){var b=$(this).data("trigger"),c=Focus.getTarget(jQuery(this),a);Focus.eventHandler(c,"toggle")}),jQuery(document).on("click","[data-close]",function(a){var b=Focus.getTarget(jQuery(this),a);b&&Focus.eventHandler(b,"hide")})});