"use strict";var Focus=function(t,e){var s=e||{};this.settings=Object.assign({visibleClass:"visible",bodyClass:"active-popup",triggerClass:null,detach:null,innerSelector:".popup-inner",autoFocusSelector:"[data-auto-focus]",slide:null,slideDuration:"fast",visible:!1,showCallback:null,hideCallback:null,error:null},s),this.visible=this.settings.visible,this.element=document.querySelector(t),this.innerElement=document.querySelector(t+" "+this.settings.innerSelector),this.closeElement=document.querySelector(t+" [data-close]"),this.target=t,this.show=this.show.bind(this),this.hide=this.hide.bind(this),this.toggle=this.toggle.bind(this),this.detach=this.detach.bind(this),this.settings.detach&&document.addEventListener("DOMContentLoaded",this.detach),Focus.elements[t]=this};Focus.elements={},Focus.getTarget=function(t){var e=t.target;return"A"===e.tagName&&t.preventDefault(),e.dataset.target||null},Focus.eventHandler=function(t,e,s){var i=Focus.elements[e];return i||(i=new Focus(e)),"hide"===s?i.hide():i.toggle()},Focus.closeEvent=function(t){var e=Focus.getTarget(t);e?Focus.eventHandler(t,e,"hide"):this.hide()},Focus.escEvent=function(t){27===t.keyCode&&(this.element.removeEventListener("keyup",Focus.escEvent),this.hide())},Focus.buildEventListeners=function(){for(var t=document.querySelectorAll("[data-trigger]"),e=function(e){var s=t[e].dataset.target;t[e].addEventListener("click",function(t){Focus.eventHandler(t,s)})},s=0;s<t.length;s+=1)e(s)},Focus.addClass=function(t,e){var s=t;s.classList&&s.classList.add(e)},Focus.removeClass=function(t,e){var s=t;s.classList&&s.classList.remove(e)},Focus.prototype.show=function(){if(this.visible&&this.element.classList.contains(this.settings.visibleClass))this.settings.error&&"function"==typeof this.settings.error&&this.settings.error("Focus: Error this element is already visible",this);else{if(this.settings.triggerClass){var t=document.querySelector('[data-target="'+this.target+'"]');Focus.addClass(t,this.settings.visibleClass)}this.settings.slide&&this.element.slideDown(this.settings.slideDuration),Focus.addClass(this.element,this.settings.visibleClass),Focus.addClass(document.body,this.settings.bodyClass),this.visible=!0;var e=document.querySelector(this.target+" "+this.settings.autoFocusSelector);e&&setTimeout(function(){e.focus()},300),this.closeElement.addEventListener("click",Focus.closeEvent.bind(this)),this.innerElement.addEventListener("click",Focus.closeEvent.bind(this)),this.element.addEventListener("keyup",Focus.escEvent.bind(this)),this.settings.showCallback&&"function"==typeof this.settings.showCallback&&this.settings.showCallback(this)}return this},Focus.prototype.hide=function(){if(this.visible||this.element.classList.contains(this.settings.visibleClass)){if(Focus.removeClass(this.element,this.settings.visibleClass),this.settings.triggerClass){var t=document.querySelector('[data-target="'+this.target+'"]');Focus.removeClass(t,this.settings.visibleClass)}this.settings.slide&&this.element.slideUp(this.settings.slideDuration),Focus.removeClass(document.body,this.settings.bodyClass),this.closeElement.removeEventListener("click",Focus.closeEvent),this.innerElement.removeEventListener("click",Focus.closeEvent),this.visible=!1,this.settings.hideCallback&&"function"==typeof this.settings.hideCallback&&this.settings.hideCallback(this)}else this.settings.error&&"function"==typeof this.settings.error&&this.settings.error("Focus: Error this element is already hidden",this);return this},Focus.prototype.toggle=function(){return this.visible?this.hide():this.show(),this},Focus.prototype.detach=function(){return document.body.appendChild(this.element),this},document.addEventListener("DOMContentLoaded",Focus.buildEventListeners);